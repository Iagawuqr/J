-- LocalScript - Teleport & Noclip GUI Melhorada

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Vari√°veis principais
local character = player.Character or player.CharacterAdded:Wait()
local savedPosition = nil
local noclipActive = false
local guiVisible = true
local dragging = false
local dragStart = nil
local startPos = nil

-- Criar ScreenGui principal
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TeleportNoclipGUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Frame principal
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 280, 0, 350)
mainFrame.Position = UDim2.new(0, 50, 0, 50)
mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Adicionar cantos arredondados
local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 12)
mainCorner.Parent = mainFrame

-- Sombra do frame principal
local shadow = Instance.new("Frame")
shadow.Name = "Shadow"
shadow.Size = UDim2.new(1, 6, 1, 6)
shadow.Position = UDim2.new(0, -3, 0, -3)
shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
shadow.BackgroundTransparency = 0.7
shadow.ZIndex = mainFrame.ZIndex - 1
shadow.Parent = mainFrame

local shadowCorner = Instance.new("UICorner")
shadowCorner.CornerRadius = UDim.new(0, 12)
shadowCorner.Parent = shadow

-- Header/T√≠tulo
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(55, 55, 70)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

-- T√≠tulo
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Size = UDim2.new(1, -80, 1, 0)
titleLabel.Position = UDim2.new(0, 10, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "üîß Teleport & Noclip"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextScaled = true
titleLabel.Font = Enum.Font.GothamBold
titleLabel.Parent = titleBar

-- Bot√£o de minimizar
local minimizeButton = Instance.new("TextButton")
minimizeButton.Name = "MinimizeButton"
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -40, 0, 5)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
minimizeButton.BorderSizePixel = 0
minimizeButton.Text = "-"
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.TextScaled = true
minimizeButton.Font = Enum.Font.GothamBold
minimizeButton.Parent = titleBar

local minimizeCorner = Instance.new("UICorner")
minimizeCorner.CornerRadius = UDim.new(0, 15)
minimizeCorner.Parent = minimizeButton

-- Container dos bot√µes
local buttonContainer = Instance.new("Frame")
buttonContainer.Name = "ButtonContainer"
buttonContainer.Size = UDim2.new(1, -20, 1, -60)
buttonContainer.Position = UDim2.new(0, 10, 0, 50)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = mainFrame

-- Layout dos bot√µes
local buttonLayout = Instance.new("UIListLayout")
buttonLayout.SortOrder = Enum.SortOrder.LayoutOrder
buttonLayout.Padding = UDim.new(0, 10)
buttonLayout.Parent = buttonContainer

-- Fun√ß√£o para criar bot√µes estilizados
local function createStyledButton(name, text, color, layoutOrder)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(1, 0, 0, 50)
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextScaled = true
    button.Font = Enum.Font.Gotham
    button.LayoutOrder = layoutOrder
    button.Parent = buttonContainer
    
    -- Cantos arredondados
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = button
    
    -- Efeito de hover
    local originalColor = color
    local hoverColor = Color3.fromRGB(
        math.min(255, color.R * 255 + 20),
        math.min(255, color.G * 255 + 20),
        math.min(255, color.B * 255 + 20)
    )
    
    button.MouseEnter:Connect(function()
        local tween = TweenService:Create(button, 
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {BackgroundColor3 = hoverColor}
        )
        tween:Play()
    end)
    
    button.MouseLeave:Connect(function()
        local tween = TweenService:Create(button, 
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {BackgroundColor3 = originalColor}
        )
        tween:Play()
    end)
    
    return button
end

-- Criar bot√µes
local savePosButton = createStyledButton("SavePosButton", "üíæ Salvar Posi√ß√£o", Color3.fromRGB(52, 152, 219), 1)
local teleportButton = createStyledButton("TeleportButton", "‚ö° Teleportar", Color3.fromRGB(46, 204, 113), 2)
local noclipButton = createStyledButton("NoclipButton", "üëª Ativar Noclip", Color3.fromRGB(155, 89, 182), 3)

-- Status label
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Size = UDim2.new(1, 0, 0, 30)
statusLabel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
statusLabel.BorderSizePixel = 0
statusLabel.Text = "üìç Posi√ß√£o n√£o salva"
statusLabel.TextColor3 = Color3.fromRGB(189, 195, 199)
statusLabel.TextScaled = true
statusLabel.Font = Enum.Font.Gotham
statusLabel.LayoutOrder = 4
statusLabel.Parent = buttonContainer

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 6)
statusCorner.Parent = statusLabel

-- Coordenadas label
local coordsLabel = Instance.new("TextLabel")
coordsLabel.Name = "CoordsLabel"
coordsLabel.Size = UDim2.new(1, 0, 0, 40)
coordsLabel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
coordsLabel.BorderSizePixel = 0
coordsLabel.Text = "X: 0 | Y: 0 | Z: 0"
coordsLabel.TextColor3 = Color3.fromRGB(127, 140, 141)
coordsLabel.TextScaled = true
coordsLabel.Font = Enum.Font.Code
coordsLabel.LayoutOrder = 5
coordsLabel.Parent = buttonContainer

local coordsCorner = Instance.new("UICorner")
coordsCorner.CornerRadius = UDim.new(0, 6)
coordsCorner.Parent = coordsLabel

-- Bot√£o flutuante quando minimizado
local floatingButton = Instance.new("TextButton")
floatingButton.Name = "FloatingButton"
floatingButton.Size = UDim2.new(0, 60, 0, 60)
floatingButton.Position = UDim2.new(0, 50, 0, 50)
floatingButton.BackgroundColor3 = Color3.fromRGB(55, 55, 70)
floatingButton.BorderSizePixel = 0
floatingButton.Text = "üîß"
floatingButton.TextColor3 = Color3.fromRGB(255, 255, 255)
floatingButton.TextScaled = true
floatingButton.Font = Enum.Font.GothamBold
floatingButton.Visible = false
floatingButton.Parent = screenGui

local floatingCorner = Instance.new("UICorner")
floatingCorner.CornerRadius = UDim.new(0, 30)
floatingCorner.Parent = floatingButton

-- Funcionalidade de arrastar
local function makeDraggable(frame, dragHandle)
    local dragging = false
    local dragStart = nil
    local startPos = nil

    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    dragHandle.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

-- Tornar a GUI arrast√°vel
makeDraggable(mainFrame, titleBar)
makeDraggable(floatingButton, floatingButton)

-- Fun√ß√£o para animar mostrar/ocultar
local function toggleGUI()
    guiVisible = not guiVisible
    
    if guiVisible then
        mainFrame.Visible = true
        floatingButton.Visible = false
        
        local tween = TweenService:Create(mainFrame, 
            TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Size = UDim2.new(0, 280, 0, 350)}
        )
        tween:Play()
    else
        local tween = TweenService:Create(mainFrame, 
            TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In),
            {Size = UDim2.new(0, 0, 0, 0)}
        )
        tween:Play()
        
        tween.Completed:Connect(function()
            mainFrame.Visible = false
            floatingButton.Visible = true
            floatingButton.Position = mainFrame.Position
        end)
    end
end

-- Eventos dos bot√µes
minimizeButton.MouseButton1Click:Connect(toggleGUI)
floatingButton.MouseButton1Click:Connect(toggleGUI)

-- Fun√ß√£o para atualizar posi√ß√£o atual
local function updateCurrentPosition()
    character = player.Character
    if character then
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            local pos = humanoidRootPart.Position
            coordsLabel.Text = string.format("X: %.1f | Y: %.1f | Z: %.1f", pos.X, pos.Y, pos.Z)
        end
    end
end

-- Fun√ß√£o para salvar posi√ß√£o
savePosButton.MouseButton1Click:Connect(function()
    character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if humanoidRootPart then
        savedPosition = humanoidRootPart.Position
        statusLabel.Text = "‚úÖ Posi√ß√£o salva!"
        statusLabel.TextColor3 = Color3.fromRGB(46, 204, 113)
        
        -- Efeito visual no bot√£o
        local originalColor = savePosButton.BackgroundColor3
        savePosButton.BackgroundColor3 = Color3.fromRGB(39, 174, 96)
        wait(0.1)
        savePosButton.BackgroundColor3 = originalColor
        
        print("Posi√ß√£o salva:", savedPosition)
    end
end)

-- Fun√ß√£o de teleporte
teleportButton.MouseButton1Click:Connect(function()
    character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if humanoidRootPart and savedPosition then
        humanoidRootPart.CFrame = CFrame.new(savedPosition)
        
        -- Efeito visual
        local originalColor = teleportButton.BackgroundColor3
        teleportButton.BackgroundColor3 = Color3.fromRGB(39, 174, 96)
        wait(0.1)
        teleportButton.BackgroundColor3 = originalColor
    else
        statusLabel.Text = "‚ùå Nenhuma posi√ß√£o salva!"
        statusLabel.TextColor3 = Color3.fromRGB(231, 76, 60)
        wait(2)
        if savedPosition then
            statusLabel.Text = "‚úÖ Posi√ß√£o salva!"
            statusLabel.TextColor3 = Color3.fromRGB(46, 204, 113)
        else
            statusLabel.Text = "üìç Posi√ß√£o n√£o salva"
            statusLabel.TextColor3 = Color3.fromRGB(189, 195, 199)
        end
    end
end)

-- Noclip toggle
noclipButton.MouseButton1Click:Connect(function()
    noclipActive = not noclipActive
    noclipButton.Text = noclipActive and "üëª Desativar Noclip" or "üëª Ativar Noclip"
    noclipButton.BackgroundColor3 = noclipActive and Color3.fromRGB(231, 76, 60) or Color3.fromRGB(155, 89, 182)
end)

-- Loop para manter noclip ativado
RunService.Stepped:Connect(function()
    if noclipActive then
        character = player.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide == true then
                    part.CanCollide = false
                end
            end
        end
    end
end)

-- Loop para atualizar coordenadas
RunService.Heartbeat:Connect(function()
    updateCurrentPosition()
end)

-- Reconectar quando o personagem respawnar
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
end)

-- Adicionar tecla de atalho (H para toggle da GUI)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.H then
        toggleGUI()
    end
end)

print("üîß Teleport & Noclip GUI carregada! Pressione H para mostrar/ocultar.")
