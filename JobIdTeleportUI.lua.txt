-- Script para copiar link do servidor privado atual do Roblox

-- Função para obter informações do servidor atual
local function getCurrentServerInfo()
    local success, result = pcall(function()
        -- Tenta acessar o serviço de TeleportService para obter o placeId atual
        local TeleportService = game:GetService("TeleportService")
        
        -- Obtém o ID do jogo atual
        local placeId = game.PlaceId
        
        -- Tenta obter o jobId (ID da sessão/servidor)
        local jobId = game.JobId or ""

        return placeId, jobId
    end)
    
    if success then
        return result
    else
        return nil, nil
    end
end

-- Função para detectar o sistema operacional
local function get_os()
    local os_name = package.config:sub(1,1) == "\\" and "windows" or "unix"
    return os_name
end

-- Função para copiar para área de transferência no Windows
local function copy_to_clipboard_windows(text)
    local pipe = io.popen('clip', 'w')
    if pipe then
        pipe:write(text)
        pipe:close()
        return true
    end
    return false
end

-- Função para copiar para área de transferência no Linux/macOS
local function copy_to_clipboard_unix(text)
    local commands = {
        'xclip -selection clipboard',
        'xsel --clipboard --input',
        'pbcopy'
    }
    
    for _, cmd in ipairs(commands) do
        local pipe = io.popen(cmd, 'w')
        if pipe then
            pipe:write(text)
            local success = pipe:close()
            if success then return true end
        end
    end
    return false
end

-- Função principal para copiar texto
local function copy_to_clipboard(text)
    local os_type = get_os()
    
    if os_type == "windows" then
        return copy_to_clipboard_windows(text)
    else
        return copy_to_clipboard_unix(text)
    end
end

-- Função para gerar o link do servidor privado
local function generatePrivateServerLink()
    local placeId, jobId = getCurrentServerInfo()
    
    if placeId and jobId and jobId ~= "" then
        -- Formato do link de servidor privado do Roblox
        local privateServerLink = "https://www.roblox.com/games/" .. placeId .. "?privateServerLinkCode=" .. jobId
        return privateServerLink
    else
        return nil
    end
end

-- Execução principal
print("🔍 Obtendo informações do servidor atual...")

local serverLink = generatePrivateServerLink()

if serverLink then
    print("✅ Servidor detectado!")
    print("🎮 Place ID: " .. game.PlaceId)
    print("🔗 Job ID: " .. game.JobId)
    print("\n📋 Gerando link do servidor privado...")
    
    -- Tentar copiar para a área de transferência
    if copy_to_clipboard(serverLink) then
        print("✅ Link copiado para a área de transferência!")
        print("🔗 Link: " .. serverLink)
        print("🎮 Agora você pode colar (Ctrl+V) para compartilhar!")
    else
        print("❌ Não foi possível copiar automaticamente")
        print("🔗 Link manual: " .. serverLink)
        print("💡 Copie manualmente o link acima")
    end
else
    print("❌ Não foi possível obter as informações do servidor")
    print("💡 Certifique-se de que está em um servidor privado válido")
    
    -- Mostrar informações disponíveis
    if game.PlaceId then
        print("🎮 Place ID: " .. game.PlaceId)
    end
    if game.JobId then
        print("🔗 Job ID: " .. game.JobId)
    end
end

-- Pausa para o usuário ver a mensagem (apenas no Windows)
if get_os() == "windows" then
    print("\n⏳ Pressione qualquer tecla para continuar...")
    os.execute("pause >nul")
end
